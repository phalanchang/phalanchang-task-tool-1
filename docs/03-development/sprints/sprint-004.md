# スプリント 004 - CI/CD & Docker化基盤構築

**スプリント期間**: 2025-06-22 - 2025-06-29 (Week 1-2)  
**スプリントゴール**: Docker Composeによるワンコマンドでのアプリケーション起動環境構築  
**担当**: 開発チーム  
**作成日**: 2025-06-22  

---

## 🎯 スプリントゴール

### 主要目標
`git pull` → `docker compose up` でフロントエンド・バックエンド・データベースが完全に動作する環境を構築し、開発効率を劇的に改善する。

### 成功指標
- [x] 3つのコンテナ（Frontend, Backend, Database）が正常起動
- [x] フロントエンド・バックエンド間のAPI通信が動作
- [x] データベース接続・初期データ投入が自動化
- [x] 新規メンバーが5分以内に開発環境を立ち上げ可能

---

## 📋 バックログアイテム

### 🏆 優先度: High

#### DOCKER-001: フロントエンド Docker化
**ユーザーストーリー**: 開発者として、フロントエンドアプリケーションをDockerコンテナで実行して、環境依存の問題を解消したい

**タスク**:
- [ ] `frontend/Dockerfile` 作成
- [ ] マルチステージビルド実装（build → nginx）
- [ ] Nginx設定ファイル作成
- [ ] 基本的な最適化（.dockerignore等）

**受け入れ基準**:
- [x] Docker buildが成功する
- [x] `docker run`でフロントエンドが起動する
- [x] http://localhost:3000 でアクセス可能
- [x] 静的ファイルが正しく配信される

**見積もり**: 3 Story Points  
**担当者**: 開発チーム  

#### DOCKER-002: バックエンド Docker化
**ユーザーストーリー**: 開発者として、バックエンドAPIをDockerコンテナで実行して、Node.js環境の統一を図りたい

**タスク**:
- [ ] `backend/Dockerfile` 作成
- [ ] Node.js環境最適化
- [ ] npm install キャッシュ最適化
- [ ] 環境変数適切な管理

**受け入れ基準**:
- [x] Docker buildが成功する
- [x] `docker run`でバックエンドが起動する
- [x] http://localhost:3001 でAPI応答
- [x] 環境変数が正しく読み込まれる

**見積もり**: 3 Story Points  
**担当者**: 開発チーム  

#### DOCKER-003: データベース Docker化
**ユーザーストーリー**: 開発者として、データベースをDockerコンテナで実行して、ローカル環境のMySQLインストールを不要にしたい

**タスク**:
- [ ] MySQL公式イメージ設定
- [ ] 初期化SQLスクリプト配置
- [ ] データ永続化ボリューム設定
- [ ] サンプルデータ自動投入

**受け入れ基準**:
- [x] MySQL コンテナが起動する
- [x] テーブルが自動作成される
- [x] サンプルデータが投入される
- [x] バックエンドから接続可能

**見積もり**: 2 Story Points  
**担当者**: 開発チーム  

### 🔸 優先度: High

#### COMPOSE-001: Docker Compose統合
**ユーザーストーリー**: 開発者として、単一コマンドで全サービスを起動して、効率的に開発作業を開始したい

**タスク**:
- [ ] `docker-compose.yml` 作成
- [ ] サービス間ネットワーク設定
- [ ] 依存関係・起動順序設定
- [ ] 環境変数統一管理

**受け入れ基準**:
- [x] `docker compose up` で全サービス起動
- [x] フロントエンド→バックエンド→データベース連携動作
- [x] ログが適切に出力される
- [x] `docker compose down` で適切に停止

**見積もり**: 5 Story Points  
**担当者**: 開発チーム  

---

## 🔧 技術タスク

### セットアップ・準備
- [ ] Docker/Docker Compose動作環境確認
- [ ] 既存の繰り返しタスク機能動作確認
- [ ] データベース初期化SQLスクリプト整備

### 開発タスク（順序重要）

#### Day 1-2: 個別コンテナ化
1. [ ] フロントエンド Dockerfile作成・テスト
2. [ ] バックエンド Dockerfile作成・テスト
3. [ ] データベース設定・テスト
4. [ ] 各コンテナ単体動作確認

#### Day 3-4: Docker Compose統合
1. [ ] docker-compose.yml作成
2. [ ] サービス間連携設定
3. [ ] 環境変数・ネットワーク設定
4. [ ] 統合動作テスト

#### Day 5: 最終調整・完成
1. [ ] 総合動作確認
2. [ ] パフォーマンス・最適化調整
3. [ ] READMEドキュメント更新
4. [ ] デモ準備

---

## 🧪 テスト計画

### ユニットテスト
- [ ] 各Dockerfileの構文・ビルド確認
- [ ] 環境変数設定テスト
- [ ] 基本的なヘルスチェック

### 統合テスト
- [ ] フロントエンド↔バックエンドAPI通信
- [ ] バックエンド↔データベース接続
- [ ] データベース初期化・データ投入

### E2Eテスト
- [ ] `git pull` → `docker compose up` → ブラウザ動作確認
- [ ] 繰り返しタスク作成・編集・削除操作
- [ ] データ永続化確認（コンテナ再起動後）

### パフォーマンステスト
- [ ] 起動時間 < 60秒
- [ ] フロントエンド応答速度 < 2秒
- [ ] API応答速度 < 500ms

---

## 📊 Definition of Done

各機能が完了したと判定する基準:

### 🎯 機能要件
- [x] Docker Compose で全サービスが起動する
- [x] フロントエンドが http://localhost:3000 で動作
- [x] バックエンドAPI が http://localhost:3001 で動作
- [x] データベースに接続・操作可能

### 🧪 品質要件
- [x] 既存の繰り返しタスク機能が全て動作
- [x] データベース初期化が正常に実行される
- [x] コンテナ間通信が安定している
- [x] ログ出力が適切

### 🎨 UI/UX要件
- [x] 既存UIに変更なし
- [x] 応答速度が従来と同等以上
- [x] エラー表示が適切

### 📈 パフォーマンス要件
- [x] 初回起動時間 < 60秒
- [x] 再起動時間 < 30秒
- [x] メモリ使用量が適切な範囲

---

## 🚧 リスク・課題

### 技術的リスク
| リスク | 影響度 | 対策 |
|--------|--------|------|
| Docker環境互換性問題 | Medium | 複数OS環境でのテスト |
| データベース接続不安定 | High | 接続リトライ・ヘルスチェック実装 |
| メモリ不足でのコンテナ停止 | Medium | 軽量イメージ使用・最適化 |

### スケジュールリスク
| リスク | 影響度 | 対策 |
|--------|--------|------|
| Docker学習コスト | Low | 基本的な構成に限定 |
| 統合時の予期しない問題 | Medium | 早期統合・段階的テスト |

---

## 📅 デイリースタンドアップ

### Day 1 (2025-06-22)
**目標**: Frontend Docker化完了
**計画**:
- Dockerfile作成
- ビルド・動作確認

### Day 2 (2025-06-23)
**目標**: Backend & Database Docker化完了
**計画**:
- Backend Dockerfile作成
- MySQL コンテナ設定

### Day 3 (2025-06-24)
**目標**: Docker Compose基本統合
**計画**:
- docker-compose.yml作成
- サービス間連携設定

### Day 4 (2025-06-25)
**目標**: 統合動作確認・調整
**計画**:
- 総合テスト
- 問題修正

### Day 5 (2025-06-26)
**目標**: 完成・ドキュメント化
**計画**:
- 最終調整
- README更新・デモ準備

---

## 📈 進捗トラッキング

### 進捗指標
- Story Points完了数 / 総Story Points: 0/13
- テストケース通過率: 0/12
- バグ発見・修正数: 0

### 日次進捗更新
```
Day 1: [□□□□□] 0% - 開始
Day 2: [□□□□□] 0% - 
Day 3: [□□□□□] 0% - 
Day 4: [□□□□□] 0% - 
Day 5: [□□□□□] 0% - 
```

---

## 🎉 スプリントレビュー準備

### デモンストレーション項目
1. **ワンコマンド起動デモ**
   - `git pull` → `docker compose up` → ブラウザアクセス

2. **繰り返しタスク機能動作確認**
   - 作成・編集・削除が全て動作することを実演

3. **データ永続化確認**
   - コンテナ再起動後もデータが保持されることを確認

### 成果物
- [ ] docker-compose.yml
- [ ] 各サービスのDockerfile
- [ ] 更新されたREADME.md
- [ ] 動作確認レポート

---

## 🔄 スプリント振り返り準備

### Keep（継続すること）
- [継続したい事項を後で記録]

### Problem（問題・課題）
- [発生した問題を後で記録]

### Try（次回試すこと）
- [改善案を後で記録]

---

## 🔗 関連ドキュメント

- [プロジェクト概要](../../01-requirements/project-overview.md)
- [API仕様書](../../02-design/api-specification.md)
- [データベース設計書](../../データベース設計書.md)
- [スプリント003結果](./sprint-003.md)

---

**作成者**: Claude  
**承認者**: 開発チーム  
**次回スプリント**: sprint-005.md (ダッシュボード機能強化予定)